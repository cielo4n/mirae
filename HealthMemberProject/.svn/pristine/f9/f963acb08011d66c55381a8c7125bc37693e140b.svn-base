package health.ui;

import health.database.MemberDao;
import health.database.MemberDto;
import health.database.RegDto;
import health.database.TrainerDao;
import health.value.StaticValues;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

//»õ È¸¿ø µî·Ï ´ÙÀÌ¾ó·Î±×
public class HealthMemberJoinDialog extends JDialog implements ActionListener {
	
	private JTextField tf_health_memberjoin_name;
	private JTextField tf_health_memberjoin_phone;
	private JTextField tf_health_memberjoin_address;
	private JTextField tf_health_memberjoin_birth_year;
	private JTextField tf_health_memberjoin_weight;
	private JTextField tf_health_memberjoin_height;
	private JTextField tf_health_join_year;

	private JComboBox cb_health_memberjoin_gender;
	private JComboBox cb_health_memberjoin_pc;
	private JComboBox cb_health_memberjoin_trainer;
	private JComboBox cb_health_join_term;
	private JComboBox cb_memberjoin_birth_month;
	private JComboBox cb_memberjoin_birth_day;
	private JComboBox cb_health_join_month;
	private JComboBox cb_health_join_day;
	private JButton btn_health_memberjoinCancel;
	private JButton btn_health_memberjoinOK;

	public HealthMemberJoinDialog(HealthMainScreen owner) { 
		super(owner);
		setResizable(false);
		setModal(true);

		setTitle("»õ È¸¿ø µî·Ï");

		setBounds(100, 100, 460, 543);
		setLocationRelativeTo(null);

		JLayeredPane layeredPane = new JLayeredPane();
		getContentPane().add(layeredPane, BorderLayout.CENTER);

		JLabel lb_health_memberjoin_name = new JLabel("ÀÌ¸§");
		lb_health_memberjoin_name.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_name.setBounds(12, 27, 48, 18);
		layeredPane.add(lb_health_memberjoin_name);

		JLabel lb_health_memberjoin_phone = new JLabel("¿¬¶ôÃ³");
		lb_health_memberjoin_phone.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_phone.setBounds(12, 62, 48, 18);
		layeredPane.add(lb_health_memberjoin_phone);

		JLabel lb_health_memberjoin_address = new JLabel("ÁÖ¼Ò");
		lb_health_memberjoin_address.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_address.setBounds(12, 98, 41, 15);
		layeredPane.add(lb_health_memberjoin_address);

		JLabel lb_health_memberjoin_birth = new JLabel("»ý³â¿ùÀÏ");
		lb_health_memberjoin_birth.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_birth.setBounds(12, 127, 68, 24);
		layeredPane.add(lb_health_memberjoin_birth);

		JLabel lb_health_memberjoin_pc = new JLabel("Ã¼Çü");
		lb_health_memberjoin_pc.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_pc.setBounds(12, 265, 48, 18);
		layeredPane.add(lb_health_memberjoin_pc);

		JLabel lb_health_memberjoin_height = new JLabel("Å°");
		lb_health_memberjoin_height.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_height.setBounds(12, 200, 57, 15);
		layeredPane.add(lb_health_memberjoin_height);

		JLabel lb_health_memberjoin_weight = new JLabel("¸ö¹«°Ô");
		lb_health_memberjoin_weight.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_weight.setBounds(12, 234, 57, 15);
		layeredPane.add(lb_health_memberjoin_weight);

		JLabel lb_health_memberjoin_gender = new JLabel("¼ºº°");
		lb_health_memberjoin_gender.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_gender.setBounds(12, 165, 48, 18);
		layeredPane.add(lb_health_memberjoin_gender);

		JLabel lb_health_memberjoin_join = new JLabel("µî·ÏÀÏ");
		lb_health_memberjoin_join.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_join.setBounds(12, 377, 57, 15);
		layeredPane.add(lb_health_memberjoin_join);

		tf_health_memberjoin_name = new JTextField();
		tf_health_memberjoin_name.setColumns(10);
		tf_health_memberjoin_name.setBounds(107, 25, 50, 24);
		layeredPane.add(tf_health_memberjoin_name);

		tf_health_memberjoin_phone = new JTextField();
		tf_health_memberjoin_phone.setColumns(10);
		tf_health_memberjoin_phone.setBounds(107, 59, 151, 24);
		layeredPane.add(tf_health_memberjoin_phone);

		tf_health_memberjoin_address = new JTextField();
		tf_health_memberjoin_address.setColumns(10);
		tf_health_memberjoin_address.setBounds(107, 94, 306, 24);
		layeredPane.add(tf_health_memberjoin_address);

		tf_health_memberjoin_birth_year = new JTextField();
		tf_health_memberjoin_birth_year.setColumns(10);
		tf_health_memberjoin_birth_year.setBounds(107, 129, 57, 24);
		layeredPane.add(tf_health_memberjoin_birth_year);

		tf_health_memberjoin_weight = new JTextField();
		tf_health_memberjoin_weight.setColumns(10);
		tf_health_memberjoin_weight.setBounds(107, 197, 100, 24);
		layeredPane.add(tf_health_memberjoin_weight);

		//¼ºº° ÄÞº¸¹Ú½º
		cb_health_memberjoin_gender = new JComboBox();
		cb_health_memberjoin_gender.setModel(new DefaultComboBoxModel(
				new Object[] { "³²¼º", "¿©¼º" }));
		cb_health_memberjoin_gender.setBounds(107, 163, 68, 24);
		layeredPane.add(cb_health_memberjoin_gender);

		//Ã¼Çü ÄÞº¸¹Ú½º
		cb_health_memberjoin_pc = new JComboBox();
		cb_health_memberjoin_pc.setModel(new DefaultComboBoxModel(
				new Object[] {"³»¹è¿±", "Áß¹è¿±", "¿Ü¹è¿±" }));
		cb_health_memberjoin_pc.setBounds(107, 265, 93, 21);
		layeredPane.add(cb_health_memberjoin_pc);

		JLabel lb_health_memberjoin_month = new JLabel("µî·Ï±â°£");
		lb_health_memberjoin_month.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_month.setBounds(12, 419, 57, 15);
		layeredPane.add(lb_health_memberjoin_month);

		JLabel lb_health_memberjoin_trainer = new JLabel("´ã´çÆ®·¹ÀÌ³Ê");
		lb_health_memberjoin_trainer.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 12));
		lb_health_memberjoin_trainer.setBounds(12, 292, 83, 26);
		layeredPane.add(lb_health_memberjoin_trainer);

		btn_health_memberjoinCancel = new JButton("Ãë ¼Ò");
		btn_health_memberjoinCancel.addActionListener(this);

		btn_health_memberjoinCancel.setBounds(242, 456, 93, 36);
		layeredPane.add(btn_health_memberjoinCancel);

		tf_health_memberjoin_height = new JTextField();
		tf_health_memberjoin_height.setColumns(10);
		tf_health_memberjoin_height.setBounds(107, 231, 100, 24);
		layeredPane.add(tf_health_memberjoin_height);

		cb_health_memberjoin_trainer = new JComboBox();
		cb_health_memberjoin_trainer.setBounds(107, 296, 93, 21);
		//Çï½ºÀå¿¡ ¼ÓÇØÀÖ´Â Æ®·¹ÀÌ³ÊµéÀ» ÄÞº¸¹Ú½º·Î °¡Á®¿È
		cb_health_memberjoin_trainer.setModel(TrainerDao.getInstance().trainerCombo(StaticValues.getSvGym_id()));
		layeredPane.add(cb_health_memberjoin_trainer);

		tf_health_join_year = new JTextField();
		tf_health_join_year.setColumns(10);
		tf_health_join_year.setBounds(88, 374, 48, 24);
		layeredPane.add(tf_health_join_year);

		JLabel lb_health_memberjoin_main = new JLabel("Çï½º ±â°£ µî·Ï");
		lb_health_memberjoin_main.setHorizontalAlignment(SwingConstants.CENTER);
		lb_health_memberjoin_main.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		lb_health_memberjoin_main.setBounds(151, 339, 126, 24);
		layeredPane.add(lb_health_memberjoin_main);

		JLabel lb_health_memberjoin_year = new JLabel("³â");
		lb_health_memberjoin_year.setHorizontalAlignment(SwingConstants.CENTER);
		lb_health_memberjoin_year.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		lb_health_memberjoin_year.setBounds(129, 374, 35, 24);
		layeredPane.add(lb_health_memberjoin_year);

		JLabel lb_health_memberjoin_m = new JLabel("¿ù");
		lb_health_memberjoin_m.setHorizontalAlignment(SwingConstants.CENTER);
		lb_health_memberjoin_m.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		lb_health_memberjoin_m.setBounds(212, 374, 35, 24);
		layeredPane.add(lb_health_memberjoin_m);

		JLabel lb_health_memberjoin_day = new JLabel("ÀÏ");
		lb_health_memberjoin_day.setHorizontalAlignment(SwingConstants.CENTER);
		lb_health_memberjoin_day.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		lb_health_memberjoin_day.setBounds(287, 374, 48, 24);
		layeredPane.add(lb_health_memberjoin_day);

		//µî·Ï±â°£(¿ù ´ÜÀ§) ÄÞº¸¹Ú½º
		cb_health_join_term = new JComboBox();
		cb_health_join_term.setModel(new DefaultComboBoxModel(new Object[] {
				1, 3, 6, 12 }));
		cb_health_join_term.setBounds(89, 417, 50, 21);
		layeredPane.add(cb_health_join_term);

		JLabel lb_health_memberjoin_rm = new JLabel("°³¿ù");
		lb_health_memberjoin_rm.setHorizontalAlignment(SwingConstants.CENTER);
		lb_health_memberjoin_rm.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		lb_health_memberjoin_rm.setBounds(110, 415, 93, 21);
		layeredPane.add(lb_health_memberjoin_rm);
		
		btn_health_memberjoinOK = new JButton("È® ÀÎ");
		btn_health_memberjoinOK.setBounds(114, 456, 93, 36);
		layeredPane.add(btn_health_memberjoinOK);
		btn_health_memberjoinOK.addActionListener(this);

		//»ý³â¿ùÀÏ Áß ¿ù ÄÞº¸¹Ú½º
		cb_memberjoin_birth_month = new JComboBox();
		cb_memberjoin_birth_month.setModel(new DefaultComboBoxModel(
				new Object[] { 1, 2, 3, 4, 5, 6, 7, 8, 9,
						10, 11, 12 }));
		cb_memberjoin_birth_month.setBounds(206, 128, 41, 24);
		layeredPane.add(cb_memberjoin_birth_month);

		JLabel lb_memberjoin_year = new JLabel("³â");
		lb_memberjoin_year.setHorizontalAlignment(SwingConstants.CENTER);
		lb_memberjoin_year.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		lb_memberjoin_year.setBounds(172, 129, 35, 24);
		layeredPane.add(lb_memberjoin_year);

		//»ý³â¿ùÀÏ Áß ÀÏ ÄÞº¸¹Ú½º
		cb_memberjoin_birth_day = new JComboBox();
		cb_memberjoin_birth_day.setModel(new DefaultComboBoxModel(new Object[] {
				1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
				13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
				23, 24, 25, 26, 27, 28, 29, 30, 31 }));
		cb_memberjoin_birth_day.setBounds(274, 128, 48, 24);
		layeredPane.add(cb_memberjoin_birth_day);

		JLabel label = new JLabel("\uC6D4");
		label.setHorizontalAlignment(SwingConstants.CENTER);
		label.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		label.setBounds(242, 129, 35, 24);
		layeredPane.add(label);

		JLabel label_1 = new JLabel("\uC77C");
		label_1.setHorizontalAlignment(SwingConstants.CENTER);
		label_1.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, 15));
		label_1.setBounds(312, 129, 48, 24);
		layeredPane.add(label_1);

		//µî·ÏÀÏ Áß ¿ù ÄÞº¸¹Ú½º
		cb_health_join_month = new JComboBox();
		cb_health_join_month.setModel(new DefaultComboBoxModel(new Object[] {
						1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 }));
		cb_health_join_month.setBounds(166, 373, 48, 24);
		layeredPane.add(cb_health_join_month);

		//µî·ÏÀÏ Áß ÀÏ ÄÞº¸¹Ú½º 
		cb_health_join_day = new JComboBox();
		cb_health_join_day.setModel(new DefaultComboBoxModel(new Object[] {
				1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
				13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
				23, 24, 25, 26, 27, 28, 29, 30, 31 }));
		cb_health_join_day.setBounds(249, 374, 48, 24);
		layeredPane.add(cb_health_join_day);
		
		setVisible(true); // ¿©±â ³¡¿¡´Ù°¡ µÖ¾ß ÇÔ
	}

	@Override
	public void actionPerformed(ActionEvent ae) {
		Object obj = ae.getSource();

		if (obj == btn_health_memberjoinOK) { // È®ÀÎ¹öÆ°
			// È®ÀÎ ´©¸£¸é »õÈ¸¿øÀÌ µî·ÏµÇ´ÂÀÌº¥Æ®
			int birth_year;
			double height;
			double weight;
			int reg_year;
			
			String name = tf_health_memberjoin_name.getText();
			String tel = tf_health_memberjoin_phone.getText();
			String addr = tf_health_memberjoin_address.getText();

			try{ //»ý³â¿ùÀÏ Áß ¿¬µµ ÀÔ·Â½Ã ¸ðµÎ ¼ýÀÚ·Î ¹Þ´ÂÁö È®ÀÎ
				birth_year = Integer.parseInt(tf_health_memberjoin_birth_year.getText());
			} catch(Exception e){ 
				//¼ýÀÚ°¡ ¾Æ´Ï¸é ¿¹¿ÜÃ³¸®
				WarningMessage.inputYearFailure();
				return;
			}
			
			//ÄÞº¸¹Ú½º¿¡ ¼±ÅÃµÈ ¿ù, ÀÏ, ¼ºº° Ç×¸ñÀ» ÀÐ¾î¿È
			int birth_month = (Integer)cb_memberjoin_birth_month.getSelectedItem();
			int birth_day = (Integer)cb_memberjoin_birth_day.getSelectedItem();
			String gender = (String)cb_health_memberjoin_gender.getSelectedItem();

			try{ //Å°¸¦ ¸ðµÎ ¼ýÀÚ·Î ¹Þ´ÂÁö È®ÀÎ
				height = Double.parseDouble(tf_health_memberjoin_height.getText());
			} catch(Exception e){
				//¼ýÀÚ°¡ ¾Æ´Ï¸é ¿¹¿ÜÃ³¸®
				WarningMessage.inputHeightFailure();
				return;
			}
			
			try{ //¸ö¹«°Ô¸¦ ¸ðµÎ ¼ýÀÚ·Î ¹Þ´ÂÁö È®ÀÎ
				weight = Double.parseDouble(tf_health_memberjoin_weight.getText());
			} catch(Exception e){
				//¼ýÀÚ°¡ ¾Æ´Ï¸é ¿¹¿ÜÃ³¸®
				WarningMessage.inputWeightFailure();
				return;
			}
			
			//ÄÞº¸¹Ú½º¿¡ ¼±ÅÃµÈ Ã¼Çü, ´ã´çÆ®·¹ÀÌ³Ê Ç×¸ñÀ» ÀÐ¾î¿È
			String shape = (String)cb_health_memberjoin_pc.getSelectedItem();
			String trainer = (String)cb_health_memberjoin_trainer.getSelectedItem();
			
			try{ //µî·Ï¿¬µµ¸¦ ¸ðµÎ ¼ýÀÚ·Î ¹Þ´ÂÁö È®ÀÎ
				reg_year = Integer.parseInt(tf_health_join_year.getText());
			} catch(Exception e){ 
				//¼ýÀÚ°¡ ¾Æ´Ï¸é ¿¹¿ÜÃ³¸®
				WarningMessage.inputRegYearFailure();
				return;
			}
			//ÄÞº¸¹Ú½º¿¡ ¼±ÅÃµÈ µî·Ï¿ù, µî·ÏÀÏ, µî·Ï±â°£À» ÀÐ¾î¿È
			int reg_month = (Integer)cb_health_join_month.getSelectedItem();
			int reg_day = (Integer)cb_health_join_day.getSelectedItem();
			int reg_term = (Integer)cb_health_join_term.getSelectedItem();
			
			//ÀÐ¾î¿Ô´ø µ¥ÀÌÅÍ¸¦ °´Ã¼·Î ¸¸µê
			MemberDto mt = new MemberDto(StaticValues.getSvGym_id(), name, tel, addr, birth_year, birth_month, birth_day, gender, height, weight, shape, trainer);
			RegDto rt = new RegDto(reg_year, reg_month, reg_day, reg_term);
			
			//È¸¿ø Å×ÀÌºí¿¡ »ðÀÔ, µî·Ï Å×ÀÌºí¿¡ »ðÀÔ
			MemberDao.getInstance().insertNewMember(mt, rt);
			WarningMessage.memberJoin(); //»õ È¸¿ø µî·Ï ¾Ë·ÁÁÜ
			dispose(); //Ã¢ ´ÝÀ½
		}

		// Ãë¼Ò¹öÆ° ´©¸§
		if (obj == btn_health_memberjoinCancel) {
			dispose(); // Ã¢´ÝÈ÷´Â ÀÌº¥Æ®
		}
	}
}
